import pyautogui
import time

def get_point(prompt):
    print(f"\nğŸ‘‰ {prompt}")
    input("   (ç§»åŠ¨é¼ æ ‡åˆ°ç›®æ ‡ä½ç½®åï¼ŒæŒ‰ã€å›è½¦é”®ã€‘ç¡®è®¤...)")
    x, y = pyautogui.position()
    print(f"   âœ… å·²è®°å½•åæ ‡: ({x}, {y})")
    return x, y

def run_calibration():
    print("==================================================")
    print("       é£ä¹¦è€ƒå‹¤åŠ©æ‰‹ - åæ ‡å¿«é€Ÿæ ¡å‡†å·¥å…·")
    print("==================================================")
    print("âš ï¸ è¯·åŠ¡å¿…å…ˆå°†é£ä¹¦çª—å£ã€æœ€å¤§åŒ–ã€‘(å…¨å±)ï¼Œç¡®ä¿åæ ‡ç»Ÿä¸€ï¼")
    
    # 1. è·å– 1å· åæ ‡
    start_x, start_y = get_point("è¯·æŠŠé¼ æ ‡æ”¾åœ¨æ—¥å†ä¸Šã€1å·ã€‘æ•°å­—çš„ä¸­å¿ƒä½ç½®")
    
    # 2. è·å– 2å· åæ ‡ (ç®—é—´è·)
    x2, _ = get_point("è¯·æŠŠé¼ æ ‡æ”¾åœ¨æ—¥å†ä¸Šã€2å·ã€‘æ•°å­—çš„ä¸­å¿ƒä½ç½®")
    step_x = abs(x2 - start_x)
    
    # 3. è·å– 8å· åæ ‡ (ç®—å‚ç›´é—´è·)
    _, y8 = get_point("è¯·æŠŠé¼ æ ‡æ”¾åœ¨æ—¥å†ä¸Šã€8å·ã€‘(1å·æ­£ä¸‹æ–¹) çš„ä¸­å¿ƒä½ç½®")
    step_y = abs(y8 - start_y)
    
    # 4. è·å–è¯¦æƒ…åŒºèŒƒå›´
    print("\n--- æ¥ä¸‹æ¥ç¡®å®šåº•éƒ¨è¯¦æƒ…åŒºçš„æˆªå›¾èŒƒå›´ ---")
    dx1, dy1 = get_point("è¯·æŠŠé¼ æ ‡æ”¾åœ¨ã€è¯¦æƒ…åŒºåŸŸã€‘çš„ã€å·¦ä¸Šè§’ã€‘ (åŒ…å«'åº”ä¸Šç­'ç­‰æ–‡å­—)")
    dx2, dy2 = get_point("è¯·æŠŠé¼ æ ‡æ”¾åœ¨ã€è¯¦æƒ…åŒºåŸŸã€‘çš„ã€å³ä¸‹è§’ã€‘ (åŒ…å«æ‰“å¡æ—¶é—´çš„å³ä¸‹è§’)")
    
    detail_w = abs(dx2 - dx1)
    detail_h = abs(dy2 - dy1)
    
    print("\n\n" + "="*50)
    print("ğŸ‰ æ ¡å‡†å®Œæˆï¼è¯·ç›´æ¥å¤åˆ¶ä¸‹é¢çš„ä»£ç å—ï¼Œè¦†ç›– main.py å¼€å¤´çš„ CONFIGï¼š")
    print("="*50)
    print(f"""
CONFIG = {{
    "start_x": {start_x},
    "start_y": {start_y},
    "step_x": {step_x},
    "step_y": {step_y},
    "detail_region": ({dx1}, {dy1}, {detail_w}, {detail_h}),
    "total_days": 31,
    "first_day_weekday": 1 
}}
""")
    print("="*50)

if __name__ == "__main__":
    run_calibration()